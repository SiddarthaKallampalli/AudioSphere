<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ genre.title() }} Songs - AudioSphere</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style1.css') }}">
    <script src="{{ url_for('static', filename='player.js') }}"></script>
</head>
<body>
    <div class="nav">
        <div class="logo">
            <img src="{{ url_for('static', filename='LogoOnlyWhite.png') }}" class="img">
            <p class="title">AudioSphere</p>
        </div>
        <div class="menu">
            <p>Menu</p>
            <div class="menu-items">
                <div class="menu-item-sep"><i class="fa-solid fa-house"></i><a class="menu-button1" href="{{ url_for('index') }}">Home</a></div>
                <div class="menu-item-sep"><i class="fa-solid fa-user-large"></i><a class="menu-button1" href="{{ url_for('artists') }}">Artist</a></div>
                <div class="menu-item-sep"><i class="fa-solid fa-envelope"></i><a class="menu-button1" href="{{ url_for('comingsoon') }}">Message</a></div>
                <div class="menu-item-sep"><i class="fa-solid fa-grip"></i><a class="menu-button1" href="{{ url_for('genres') }}">Genre</a></div>
                <div class="menu-item-sep"><i class="fa-solid fa-user-plus"></i><a class="menu-button1" href="{{ url_for('signup') }}">SignUp</a></div>
                <div class="menu-item-sep"><i class="fa-solid fa-user"></i><a class="menu-button1" href="{{ url_for('profile', username=username, email=email) }}">Profile</a></div>
            </div>
        </div>
    </div>

    <div class="content">
        <div class="search-login">
            <div class="search">
                <form action="{{ url_for('search_songs') }}" method="POST">
                    <i class="fa-solid fa-magnifying-glass"></i>
                    <input type="text" name="query" class="search-input" placeholder="Search songs, artist, albums">
                </form>
            </div>
        </div>

        <p class="recommend">{{ genre.title() }} Songs</p>

        <div class="songs">
            {% if songs %}
                {% for song in songs %}
                    <div class="song-box" onclick="playSong('{{ song.song_url }}', '{{ song.name }}', '{{ song.artist }}', '{{ song.photo_url }}')">
                        <img src="{{ song.photo_url }}" class="song-photo">
                        <p class="song-name">{{ song.name }}</p>
                        <p class="artist-name">{{ song.artist }}</p>
                    </div>
                {% endfor %}
            {% else %}
                <p>No songs found for this genre.</p>
            {% endif %}
        </div>

        <hr>
        <div class="creators">
            <p>Created By</p>
            <div>
                <a target="_blank" href="https://www.linkedin.com/in/abhilashmellacheruvu/">Abhilash Mellacheruvu</a> |
                <a target="_blank" href="https://www.linkedin.com/in/siddartha-kallampalli-a8982a2a3">Siddartha Kallampalli</a>
            </div>
        </div>
    </div>

        <div class="player">
            <img id="song-photo" class="song-photo-player" src="{{ url_for('static', filename='default_cover.jpg') }}" alt="Cover Art" />
            <div class="info-audio">
                <div id="song-info" class="player-info">
                    <p id="song-name" class="song-name-player">Select a song</p>
                    <p id="artist-name" class="artist-name-player">Artist Name</p>
                </div>
                <div class="audio-player">
                      <audio id="audioPlayer" controls></audio>
                </div>
            </div>
        </div>

    <script>
        function playSong(url, name, artist, photo) {
            const audioPlayer = document.getElementById('audioPlayer');
            const songName = document.getElementById('song-name');
            const artistName = document.getElementById('artist-name');
            const songPhoto = document.getElementById('song-photo');

            audioPlayer.src = url;
            audioPlayer.play();

            songName.textContent = name;
            artistName.textContent = artist;
            songPhoto.src = photo;

            localStorage.setItem('playbackState', JSON.stringify({
                currentSong: url,
                currentTime: 0,
                songName: name,
                artistName: artist,
                photoURL: photo
            }));
        }
    </script>
</body>
</html>
